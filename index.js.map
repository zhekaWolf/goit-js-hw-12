{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// HTTP-запросы к Pixabay (axios + async/await)\n\nimport axios from 'axios';\n\n// Сколько карточек на один запрос — по ТЗ 15\nexport const PER_PAGE = 15;\n\n// ⚠️ ВСТАВЬ СВОЙ КЛЮЧ (оставь как строку):\nconst API_KEY = '53049514-dee19204cd3e9e15730e86423';\n\nconst api = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n  },\n});\n\n/**\n * Получить изображения по запросу и номеру страницы\n * @param {string} query\n * @param {number} page\n * @returns {Promise<{totalHits:number, hits:Array}>}\n */\nexport async function getImagesByQuery(query, page = 1) {\n  const { data } = await api.get('', { params: { q: query, page } });\n  return data;\n}\n","// Рендер, модалка, лоадер, тосты, кнопка Load more\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst gallery = document.querySelector('#gallery');\nconst loader  = document.querySelector('#loader');      // элемент-лоадер\nconst btnMore = document.querySelector('#load-more');   // кнопка \"Load more\"\n\n// Однажды создаём lightbox для ссылок внутри .gallery\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images.map(cardTpl).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  // Добавляем класс показа и убираем hidden (на случай, если он использовался)\n  loader.classList.add('is-visible');\n  loader.hidden = false;\n}\nexport function hideLoader() {\n  loader.classList.remove('is-visible');\n  loader.hidden = true;\n}\n\nexport function showLoadMoreButton() {\n  btnMore.classList.add('is-visible');\n  btnMore.hidden = false;\n}\nexport function hideLoadMoreButton() {\n  btnMore.classList.remove('is-visible');\n  btnMore.hidden = true;\n}\n\nexport function showInfo(message) {\n  iziToast.info({ message, position: 'topRight' });\n}\nexport function showSuccess(message) {\n  iziToast.success({ message, position: 'topRight' });\n}\nexport function showError(message) {\n  iziToast.error({ message, position: 'topRight' });\n}\n\nexport function smoothScrollAfterAppend() {\n  const first = gallery.firstElementChild;\n  if (!first) return;\n  const { height } = first.getBoundingClientRect();\n  window.scrollBy({ top: height * 2, behavior: 'smooth' });\n}\n\nfunction cardTpl({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) {\n  return `\n<li class=\"photo-card\">\n  <a class=\"gallery__link\" href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${escapeHtml(tags)}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n    <p><b>Likes</b> ${likes}</p>\n    <p><b>Views</b> ${views}</p>\n    <p><b>Comments</b> ${comments}</p>\n    <p><b>Downloads</b> ${downloads}</p>\n  </div>\n</li>`;\n}\n\n// маленькая защита alt от спецсимволов\nfunction escapeHtml(str = '') {\n  return String(str)\n    .replaceAll('&', '&amp;')\n    .replaceAll('<', '&lt;')\n    .replaceAll('>', '&gt;')\n    .replaceAll('\"', '&quot;')\n    .replaceAll(\"'\", '&#39;');\n}\n","// src/js/main.js\nimport { getImagesByQuery, PER_PAGE } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showInfo,\n  showSuccess,\n  showError,\n  smoothScrollAfterAppend,\n} from './js/render-functions.js';\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  input: document.querySelector('#search-form [name=\"query\"]'),\n  gallery: document.querySelector('#gallery'),\n  loadMore: document.querySelector('#load-more'),\n};\n\n// Глобальний стан\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\n// Початково кнопка прихована\nhideLoadMoreButton();\n\n// Події\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadMore.addEventListener('click', onLoadMore);\n\n// ===== helpers to control Load More button =====\nfunction showLoadMoreButton() {\n  refs.loadMore.hidden = false;\n}\nfunction hideLoadMoreButton() {\n  refs.loadMore.hidden = true;\n}\n\n// ===== Handlers =====\nasync function onSearch(e) {\n  e.preventDefault();\n\n  query = refs.input.value.trim();\n  if (!query) {\n    showInfo('Enter a search term');\n    return;\n  }\n\n  // Скидаємо стан для нового пошуку\n  page = 1;\n  totalHits = 0;\n  clearGallery();\n  hideLoadMoreButton(); // кнопка схована до отримання результатів\n\n  showLoader();\n  try {\n    const data = await getImagesByQuery(query, page);\n    totalHits = data.totalHits ?? 0;\n\n    if (!totalHits) {\n      showError('Sorry, no images match your search query.');\n      return;\n    }\n\n    // Малюємо першу сторінку\n    createGallery(data.hits);\n    showSuccess(`Hooray! We found ${totalHits} images.`);\n\n    // Якщо є ще сторінки — показуємо кнопку; інакше — повідомляємо про кінець\n    if (page * PER_PAGE < totalHits) {\n      showLoadMoreButton();\n    } else {\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (err) {\n    showError(err.message || 'Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n\n  hideLoadMoreButton(); // ховаємо на час запиту\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    createGallery(data.hits);\n\n    // Якщо дійшли до кінця — повідомляємо; інакше повертаємо кнопку\n    if (page * PER_PAGE >= totalHits) {\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      showLoadMoreButton();\n    }\n\n    smoothScrollAfterAppend();\n  } catch (err) {\n    showError(err.message || 'Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\n\n"],"names":["PER_PAGE","API_KEY","api","axios","getImagesByQuery","query","page","data","gallery","loader","lightbox","SimpleLightbox","createGallery","images","markup","cardTpl","clearGallery","showLoader","hideLoader","showInfo","message","iziToast","showSuccess","showError","smoothScrollAfterAppend","first","height","webformatURL","largeImageURL","tags","likes","views","comments","downloads","escapeHtml","str","refs","totalHits","hideLoadMoreButton","onSearch","onLoadMore","showLoadMoreButton","err"],"mappings":"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"}