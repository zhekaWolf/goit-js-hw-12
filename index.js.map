{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const PER_PAGE = 15; // по ТЗ HW-12\n\nconst API_KEY = '53049514-dee19204cd3e9e15730e86423'; \n\nconst api = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n  },\n});\n\n/**\n * @param {string} query - поисковый запрос\n * @param {number} page  - номер страницы (1..n)\n * @returns {Promise<{totalHits:number, hits:Array}>}\n */\nexport async function getImagesByQuery(query, page = 1) {\n  const { data } = await api.get('', { params: { q: query, page } });\n  return data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst galleryEl = document.querySelector('#gallery');\nconst loaderEl = document.querySelector('#loader');\nconst loadMoreBtn = document.querySelector('#load-more');\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images.map(cardTpl).join('');\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nexport function showLoader() {\n  loaderEl.classList.remove('hidden');\n}\nexport function hideLoader() {\n  loaderEl.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.hidden = false;\n}\nexport function hideLoadMoreButton() {\n  loadMoreBtn.hidden = true;\n}\n\nexport function showInfo(message) {\n  iziToast.info({ message, position: 'topRight' });\n}\nexport function showSuccess(message) {\n  iziToast.success({ message, position: 'topRight' });\n}\nexport function showError(message) {\n  iziToast.error({ message, position: 'topRight' });\n}\n\nexport function smoothScrollAfterAppend() {\n  const first = galleryEl.firstElementChild;\n  if (!first) return;\n  const { height } = first.getBoundingClientRect();\n  window.scrollBy({ top: height * 2, behavior: 'smooth' });\n}\n\nfunction cardTpl({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `\n<li class=\"photo-card\">\n  <a href=\"${largeImageURL}\" class=\"gallery__link\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n    <p><b>Likes</b> ${likes}</p>\n    <p><b>Views</b> ${views}</p>\n    <p><b>Comments</b> ${comments}</p>\n    <p><b>Downloads</b> ${downloads}</p>\n  </div>\n</li>`;\n}\n","// src/main.js\nimport { getImagesByQuery, PER_PAGE } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showInfo,\n  showSuccess,\n  showError,\n  smoothScrollAfterAppend,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions.js';\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  input: document.querySelector('#search-form [name=\"query\"]'),\n  loadMore: document.querySelector('#load-more'),\n};\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadMore.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n  query = refs.input.value.trim();\n  if (!query) {\n    showInfo('Enter a search term');\n    return;\n  }\n\n  page = 1;\n  totalHits = 0;\n  clearGallery();\n  hideLoadMoreButton();\n\n  showLoader();\n  try {\n    const data = await getImagesByQuery(query, page);\n    totalHits = data.totalHits;\n\n    if (!totalHits) {\n      showError('Sorry, no images match your search query.');\n      return;\n    }\n\n    createGallery(data.hits);\n    showSuccess(`Hooray! We found ${totalHits} images.`);\n\n    if (page * PER_PAGE < totalHits) showLoadMoreButton();\n  } catch (err) {\n    console.error(err);\n    showError('Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    createGallery(data.hits);\n\n    if (page * PER_PAGE >= totalHits) {\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      showLoadMoreButton();\n    }\n\n    smoothScrollAfterAppend();\n  } catch (err) {\n    console.error(err);\n    showError('Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\n\n"],"names":["PER_PAGE","API_KEY","api","axios","getImagesByQuery","query","page","data","galleryEl","loaderEl","loadMoreBtn","lightbox","SimpleLightbox","createGallery","images","markup","cardTpl","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","showInfo","message","iziToast","showSuccess","showError","smoothScrollAfterAppend","first","height","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","totalHits","onSearch","onLoadMore","err"],"mappings":"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"}