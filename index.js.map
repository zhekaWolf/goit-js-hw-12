{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// HTTP-запросы к Pixabay (axios + async/await)\n\nimport axios from 'axios';\n\n// Сколько карточек на один запрос — по ТЗ 15\nexport const PER_PAGE = 15;\n\n// ⚠️ ВСТАВЬ СВОЙ КЛЮЧ (оставь как строку):\nconst API_KEY = '53049514-dee19204cd3e9e15730e86423';\n\nconst api = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n  },\n});\n\n/**\n * Получить изображения по запросу и номеру страницы\n * @param {string} query\n * @param {number} page\n * @returns {Promise<{totalHits:number, hits:Array}>}\n */\nexport async function getImagesByQuery(query, page = 1) {\n  const { data } = await api.get('', { params: { q: query, page } });\n  return data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst gallery = document.querySelector('#gallery');\nconst loader  = document.querySelector('#loader');\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images.map(cardTpl).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader()  { loader.classList.remove('hidden'); }\nexport function hideLoader()  { loader.classList.add('hidden'); }\n\nexport function showInfo(message)    { iziToast.info({    message, position: 'topRight' }); }\nexport function showSuccess(message) { iziToast.success({ message, position: 'topRight' }); }\nexport function showError(message)   { iziToast.error({   message, position: 'topRight' }); }\n\nexport function smoothScrollAfterAppend() {\n  const first = gallery.firstElementChild;\n  if (!first) return;\n  const { height } = first.getBoundingClientRect();\n  window.scrollBy({ top: height * 2, behavior: 'smooth' });\n}\n\nfunction cardTpl({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) {\n  return `\n<li class=\"photo-card\">\n  <a href=\"${largeImageURL}\" class=\"gallery__link\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n    <p><b>Likes</b> ${likes}</p>\n    <p><b>Views</b> ${views}</p>\n    <p><b>Comments</b> ${comments}</p>\n    <p><b>Downloads</b> ${downloads}</p>\n  </div>\n</li>`;\n}\n\n","// main.js  (файл лежит в src/)\n\nimport { getImagesByQuery, PER_PAGE } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showInfo,\n  showSuccess,\n  showError,\n  smoothScrollAfterAppend,\n} from './js/render-functions.js';\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  input: document.querySelector('#search-form [name=\"query\"]'),\n  gallery: document.querySelector('#gallery'),\n  loadMore: document.querySelector('#load-more'),\n};\n\n// helpers to show/hide the Load More button (class-based)\nfunction showLoadMoreButton() {\n  refs.loadMore.classList.remove('hidden');\n}\nfunction hideLoadMoreButton() {\n  refs.loadMore.classList.add('hidden');\n}\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\n// прячем Load More при загрузке страницы\nhideLoadMoreButton();\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadMore.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  query = refs.input.value.trim();\n  if (!query) {\n    showInfo('Enter a search term');\n    return;\n  }\n\n  page = 1;\n  totalHits = 0;\n  clearGallery();\n  hideLoadMoreButton();\n\n  showLoader();\n  try {\n    const data = await getImagesByQuery(query, page);\n    totalHits = data.totalHits ?? 0;\n\n    if (!totalHits) {\n      showError('Sorry, no images match your search query.');\n      return;\n    }\n\n    createGallery(data.hits);\n    showSuccess(`Hooray! We found ${totalHits} images.`);\n\n    // первая страница: либо показываем Load More, либо сразу говорим что это конец\n    if (page * PER_PAGE < totalHits) {\n      showLoadMoreButton();\n    } else {\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (err) {\n    showError(err.message || 'Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    createGallery(data.hits);\n\n    if (page * PER_PAGE >= totalHits) {\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      showLoadMoreButton();\n    }\n\n    smoothScrollAfterAppend();\n  } catch (err) {\n    showError(err.message || 'Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\n\n"],"names":["PER_PAGE","API_KEY","api","axios","getImagesByQuery","query","page","data","gallery","loader","lightbox","SimpleLightbox","createGallery","images","markup","cardTpl","clearGallery","showLoader","hideLoader","showInfo","message","iziToast","showSuccess","showError","smoothScrollAfterAppend","first","height","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","showLoadMoreButton","hideLoadMoreButton","totalHits","onSearch","onLoadMore","err"],"mappings":"owBAKO,MAAMA,EAAW,GAGlBC,EAAU,qCAEVC,EAAMC,EAAM,OAAO,CACvB,QAAS,2BACT,OAAQ,CACN,IAAKF,EACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUD,CACX,CACH,CAAC,EAQM,eAAeI,EAAiBC,EAAOC,EAAO,EAAG,CACtD,KAAM,CAAE,KAAAC,CAAM,EAAG,MAAML,EAAI,IAAI,GAAI,CAAE,OAAQ,CAAE,EAAGG,EAAO,KAAAC,CAAI,CAAI,CAAA,EACjE,OAAOC,CACT,CCxBA,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,SAAS,EAEhD,IAAIC,EAAW,IAAIC,EAAe,aAAc,CAC9C,SAAU,GACV,aAAc,MACd,aAAc,GAChB,CAAC,EAEM,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAASD,EAAO,IAAIE,CAAO,EAAE,KAAK,EAAE,EAC1CP,EAAQ,mBAAmB,YAAaM,CAAM,EAC9CJ,EAAS,QAAO,CAClB,CAEO,SAASM,GAAe,CAC7BR,EAAQ,UAAY,EACtB,CAEO,SAASS,GAAc,CAAER,EAAO,UAAU,OAAO,QAAQ,CAAI,CAC7D,SAASS,GAAc,CAAET,EAAO,UAAU,IAAI,QAAQ,CAAI,CAE1D,SAASU,EAASC,EAAY,CAAEC,EAAS,KAAK,CAAK,QAAAD,EAAS,SAAU,UAAY,CAAA,CAAI,CACtF,SAASE,EAAYF,EAAS,CAAEC,EAAS,QAAQ,CAAE,QAAAD,EAAS,SAAU,UAAY,CAAA,CAAI,CACtF,SAASG,EAAUH,EAAW,CAAEC,EAAS,MAAM,CAAI,QAAAD,EAAS,SAAU,UAAY,CAAA,CAAI,CAEtF,SAASI,GAA0B,CACxC,MAAMC,EAAQjB,EAAQ,kBACtB,GAAI,CAACiB,EAAO,OACZ,KAAM,CAAE,OAAAC,CAAM,EAAKD,EAAM,sBAAqB,EAC9C,OAAO,SAAS,CAAE,IAAKC,EAAS,EAAG,SAAU,QAAQ,CAAE,CACzD,CAEA,SAASX,EAAQ,CAAE,aAAAY,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,GAAa,CACzF,MAAO;AAAA;AAAA,aAEIL,CAAa;AAAA,gBACVD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,sBAGpBC,CAAK;AAAA,sBACLC,CAAK;AAAA,yBACFC,CAAQ;AAAA,0BACPC,CAAS;AAAA;AAAA,MAGnC,CCtCA,MAAMC,EAAO,CACX,KAAM,SAAS,cAAc,cAAc,EAC3C,MAAO,SAAS,cAAc,6BAA6B,EAC3D,QAAS,SAAS,cAAc,UAAU,EAC1C,SAAU,SAAS,cAAc,YAAY,CAC/C,EAGA,SAASC,GAAqB,CAC5BD,EAAK,SAAS,UAAU,OAAO,QAAQ,CACzC,CACA,SAASE,GAAqB,CAC5BF,EAAK,SAAS,UAAU,IAAI,QAAQ,CACtC,CAEA,IAAI7B,EAAQ,GACRC,EAAO,EACP+B,EAAY,EAGhBD,IAEAF,EAAK,KAAK,iBAAiB,SAAUI,CAAQ,EAC7CJ,EAAK,SAAS,iBAAiB,QAASK,CAAU,EAElD,eAAeD,EAAS,EAAG,CAIzB,GAHA,EAAE,eAAc,EAEhBjC,EAAQ6B,EAAK,MAAM,MAAM,KAAI,EACzB,CAAC7B,EAAO,CACVc,EAAS,qBAAqB,EAC9B,MACD,CAEDb,EAAO,EACP+B,EAAY,EACZrB,IACAoB,IAEAnB,IACA,GAAI,CACF,MAAMV,EAAO,MAAMH,EAAiBC,EAAOC,CAAI,EAG/C,GAFA+B,EAAY9B,EAAK,WAAa,EAE1B,CAAC8B,EAAW,CACdd,EAAU,2CAA2C,EACrD,MACD,CAEDX,EAAcL,EAAK,IAAI,EACvBe,EAAY,oBAAoBe,CAAS,UAAU,EAG/C/B,EAAON,EAAWqC,EACpBF,IAEAhB,EAAS,4DAA4D,CAExE,OAAQqB,EAAK,CACZjB,EAAUiB,EAAI,SAAW,wCAAwC,CACrE,QAAY,CACRtB,GACD,CACH,CAEA,eAAeqB,GAAa,CAC1BjC,GAAQ,EACR8B,IACAnB,IAEA,GAAI,CACF,MAAMV,EAAO,MAAMH,EAAiBC,EAAOC,CAAI,EAC/CM,EAAcL,EAAK,IAAI,EAEnBD,EAAON,GAAYqC,EACrBlB,EAAS,4DAA4D,EAErEgB,IAGFX,GACD,OAAQgB,EAAK,CACZjB,EAAUiB,EAAI,SAAW,wCAAwC,CACrE,QAAY,CACRtB,GACD,CACH"}